# 9ì¥

ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬Â·ìš´ì˜ â€” ConfigMap, Secret, ë¡¤ë§ ì—…ë°ì´íŠ¸, Kustomize, Helm, Metrics Server, HPA, Dashboard

```
                    ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ & ìš´ì˜
                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼          â–¼           â–¼           â–¼              â–¼
 ConfigMap   Secret     Rolling     íŒ¨í‚¤ì§•/ë°°í¬     ëª¨ë‹ˆí„°ë§/ìŠ¤ì¼€ì¼ë§
 (ì„¤ì • ì£¼ì…) (ì•”í˜¸í™”    Update     (Kustomize,    (Metrics Server,
             ì„¤ì • ì£¼ì…)  (set,       Helm)         HPA, Dashboard)
                       rollout)
```

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì»¨í”¼ê·¸ë§µ(ConfigMap)ì„ ì´ìš©í•´ ì¶”ê°€ ì„¤ì • ë„£ê¸°

**ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì™€ ì„¤ì •ì„ ë¶„ë¦¬**í•˜ì—¬ í™˜ê²½ë³„ë¡œ ë‹¤ë¥¸ ì„¤ì •ì„ ì£¼ì…í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜

```
ê¸°ì¡´ ë¬¸ì œ:
  ì„¤ì •ì´ ì´ë¯¸ì§€ì— í¬í•¨ â†’ í™˜ê²½(dev/staging/prod)ë§ˆë‹¤ ì´ë¯¸ì§€ë¥¼ ë”°ë¡œ ë¹Œë“œí•´ì•¼ í•¨

ConfigMap í•´ê²°:
  ì´ë¯¸ì§€ëŠ” í•˜ë‚˜ + ConfigMapìœ¼ë¡œ í™˜ê²½ë³„ ì„¤ì •ë§Œ êµì²´

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ë™ì¼í•œ   â”‚ â†â”€â”€ â”‚ ConfigMap    â”‚
  â”‚  ì´ë¯¸ì§€   â”‚     â”‚ (dev ì„¤ì •)   â”‚  â†’ dev í™˜ê²½
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ ConfigMap    â”‚
                   â”‚ (prod ì„¤ì •)  â”‚  â†’ prod í™˜ê²½
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ConfigMap ìƒì„±

```bash
# ë¦¬í„°ëŸ´ ê°’ìœ¼ë¡œ ìƒì„±
kubectl create configmap my-config \
  --from-literal=DB_HOST=mysql-service \
  --from-literal=DB_PORT=3306 \
  --from-literal=LOG_LEVEL=info

# íŒŒì¼ë¡œ ìƒì„±
kubectl create configmap app-config --from-file=app.properties

# env íŒŒì¼ë¡œ ìƒì„± (KEY=VALUE í˜•ì‹)
kubectl create configmap app-config --from-env-file=app.env
```

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: my-config
data:                        # ì¼ë°˜ í…ìŠ¤íŠ¸ ë°ì´í„°
  DB_HOST: mysql-service
  DB_PORT: "3306"            # ìˆ«ìë„ ë¬¸ìì—´ë¡œ ì €ì¥
  LOG_LEVEL: info
  app.properties: |          # íŒŒì¼ ë‚´ìš©ë„ ì €ì¥ ê°€ëŠ¥ (ë©€í‹°ë¼ì¸)
    server.port=8080
    spring.datasource.url=jdbc:mysql://mysql:3306/mydb
    spring.profiles.active=production
```

### ConfigMap ì‚¬ìš© ë°©ì‹

```
ConfigMap ì‚¬ìš© ë°©ì‹ 3ê°€ì§€:

1. í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…
   ConfigMap â”€â”€(env)â”€â”€â†’ ì»¨í…Œì´ë„ˆ í™˜ê²½ ë³€ìˆ˜

2. ë³¼ë¥¨ ë§ˆìš´íŠ¸ë¡œ íŒŒì¼ ì£¼ì…
   ConfigMap â”€â”€(volume)â”€â”€â†’ ì»¨í…Œì´ë„ˆ ë‚´ íŒŒì¼

3. ì»¤ë§¨ë“œ ì¸ìë¡œ ì£¼ì…
   ConfigMap â”€â”€(args)â”€â”€â†’ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì¸ì
```

**1. í™˜ê²½ ë³€ìˆ˜ â€” ê°œë³„ í‚¤ ì£¼ì… (valueFrom)**
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: config-env-pod
spec:
  containers:
    - name: app
      image: my-app:v1
      env:
        - name: DATABASE_HOST          # ì»¨í…Œì´ë„ˆì—ì„œ ì‚¬ìš©í•  í™˜ê²½ ë³€ìˆ˜ëª…
          valueFrom:
            configMapKeyRef:
              name: my-config          # ConfigMap ì´ë¦„
              key: DB_HOST             # ConfigMap ë‚´ í‚¤
```

**2. í™˜ê²½ ë³€ìˆ˜ â€” ì „ì²´ í‚¤ ì¼ê´„ ì£¼ì… (envFrom)**
```yaml
spec:
  containers:
    - name: app
      image: my-app:v1
      envFrom:
        - configMapRef:
            name: my-config            # ConfigMapì˜ ëª¨ë“  í‚¤ê°€ í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…
          prefix: APP_                  # ì„ íƒ: ì ‘ë‘ì‚¬ ì¶”ê°€ â†’ APP_DB_HOST, APP_DB_PORT
```

**3. ë³¼ë¥¨ ë§ˆìš´íŠ¸ â€” íŒŒì¼ë¡œ ì£¼ì…**
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: config-volume-pod
spec:
  containers:
    - name: app
      image: my-app:v1
      volumeMounts:
        - name: config-vol
          mountPath: /etc/config       # ì´ ë””ë ‰í† ë¦¬ì— ConfigMap í‚¤ê°€ íŒŒì¼ë¡œ ìƒì„±
          readOnly: true
  volumes:
    - name: config-vol
      configMap:
        name: my-config
        items:                         # ì„ íƒ: íŠ¹ì • í‚¤ë§Œ ë§ˆìš´íŠ¸
          - key: app.properties
            path: application.properties  # íŒŒì¼ëª… ë³€ê²½ ê°€ëŠ¥
```

```
ë³¼ë¥¨ ë§ˆìš´íŠ¸ ê²°ê³¼:
/etc/config/
 â”œâ”€ DB_HOST          â†’ ë‚´ìš©: "mysql-service"
 â”œâ”€ DB_PORT          â†’ ë‚´ìš©: "3306"
 â”œâ”€ LOG_LEVEL        â†’ ë‚´ìš©: "info"
 â””â”€ app.properties   â†’ ë‚´ìš©: "server.port=8080\n..."

itemsë¥¼ ì§€ì •í•˜ë©´:
/etc/config/
 â””â”€ application.properties  â†’ ë‚´ìš©: "server.port=8080\n..."
```

### ConfigMap ì—…ë°ì´íŠ¸ì™€ ë°˜ì˜

| ì£¼ì… ë°©ì‹ | ConfigMap ìˆ˜ì • ì‹œ ìë™ ë°˜ì˜ | ë¹„ê³  |
| --- | --- | --- |
| í™˜ê²½ ë³€ìˆ˜ (env/envFrom) | **X** â€” Pod ì¬ì‹œì‘ í•„ìš” | í™˜ê²½ ë³€ìˆ˜ëŠ” í”„ë¡œì„¸ìŠ¤ ì‹œì‘ ì‹œ ê²°ì • |
| ë³¼ë¥¨ ë§ˆìš´íŠ¸ | **O** â€” ìë™ ê°±ì‹  (ìˆ˜ì‹­ ì´ˆ~ìˆ˜ ë¶„) | kubeletì˜ sync ì£¼ê¸°ì— ë”°ë¦„ |
| subPath ë³¼ë¥¨ ë§ˆìš´íŠ¸ | **X** â€” ìë™ ê°±ì‹  ì•ˆë¨ | subPathëŠ” ì‹¬ë³¼ë¦­ ë§í¬ ì•„ë‹˜ |

### ì£¼ì˜ì‚¬í•­

- ConfigMapì€ **1MiB** í¬ê¸° ì œí•œ
- ConfigMapì€ **ì•”í˜¸í™”ë˜ì§€ ì•ŠìŒ** â†’ ë¯¼ê° ì •ë³´ëŠ” Secret ì‚¬ìš©
- ConfigMapì´ ì—†ëŠ” ìƒíƒœì—ì„œ Podê°€ ì°¸ì¡°í•˜ë©´ **Pod ìƒì„± ì‹¤íŒ¨** (optional: trueë¡œ íšŒí”¼ ê°€ëŠ¥)
- `immutable: true` ì„¤ì • ì‹œ ìˆ˜ì • ë¶ˆê°€ â†’ ì‹¤ìˆ˜ ë°©ì§€, ì„±ëŠ¥ í–¥ìƒ (ì‚­ì œ í›„ ì¬ìƒì„±ë§Œ ê°€ëŠ¥)

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì‹œí¬ë¦¿(Secret)ì„ ì´ìš©í•´ ì¶”ê°€ ì„¤ì •ì„ ì•”í˜¸í™”í•´ì„œ ë„£ê¸°

**ë¯¼ê° ì •ë³´(ë¹„ë°€ë²ˆí˜¸, í† í°, ì¸ì¦ì„œ ë“±)**ë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê³  Podì— ì£¼ì…í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜

```
ConfigMap vs Secret:

ConfigMap:
  í‰ë¬¸ ì €ì¥ â†’ DB í˜¸ìŠ¤íŠ¸, í¬íŠ¸, ë¡œê·¸ ë ˆë²¨ ë“± ì¼ë°˜ ì„¤ì •

Secret:
  Base64 ì¸ì½”ë”© ì €ì¥ â†’ ë¹„ë°€ë²ˆí˜¸, API í‚¤, TLS ì¸ì¦ì„œ ë“± ë¯¼ê° ì •ë³´
  (etcdì—ì„œ ì•”í˜¸í™” ê°€ëŠ¥, RBACìœ¼ë¡œ ì ‘ê·¼ ì œì–´)
```

### Secret íƒ€ì…

| íƒ€ì… | ì„¤ëª… | ìš©ë„ |
| --- | --- | --- |
| `Opaque` | ê¸°ë³¸ íƒ€ì…, ì„ì˜ì˜ key-value | ë¹„ë°€ë²ˆí˜¸, API í‚¤ ë“± |
| `kubernetes.io/dockerconfigjson` | Docker ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ì¦ | í”„ë¼ì´ë¹— ì´ë¯¸ì§€ pull |
| `kubernetes.io/tls` | TLS ì¸ì¦ì„œ + í‚¤ | Ingress TLS ë“± |
| `kubernetes.io/service-account-token` | SA í† í° | API ì„œë²„ ì¸ì¦ (ìë™ ìƒì„±) |

### Secret ìƒì„±

```bash
# ë¦¬í„°ëŸ´ ê°’ìœ¼ë¡œ ìƒì„±
kubectl create secret generic db-secret \
  --from-literal=username=admin \
  --from-literal=password='S3cur3P@ss!'

# TLS Secret ìƒì„±
kubectl create secret tls my-tls-secret \
  --cert=./server.crt \
  --key=./server.key
```

```yaml
# data: Base64 ì¸ì½”ë”©ëœ ê°’
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
data:
  username: YWRtaW4=           # echo -n 'admin' | base64
  password: UzNjdXIzUEBzcyE=  # echo -n 'S3cur3P@ss!' | base64

# stringData: í‰ë¬¸ìœ¼ë¡œ ì‘ì„± â†’ ì ìš© ì‹œ ìë™ Base64 ì¸ì½”ë”©
# stringData:
#   username: admin
#   password: S3cur3P@ss!
```

### Secret ì‚¬ìš© ë°©ì‹

ConfigMapê³¼ ë™ì¼í•œ ë°©ì‹ (í™˜ê²½ ë³€ìˆ˜, ë³¼ë¥¨ ë§ˆìš´íŠ¸)ìœ¼ë¡œ ì‚¬ìš©. `configMapKeyRef` ëŒ€ì‹  `secretKeyRef` ì‚¬ìš©.

**í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…**
```yaml
env:
  - name: DB_PASSWORD
    valueFrom:
      secretKeyRef:
        name: db-secret
        key: password
```

**ë³¼ë¥¨ ë§ˆìš´íŠ¸ë¡œ íŒŒì¼ ì£¼ì…**
```yaml
volumes:
  - name: secret-vol
    secret:
      secretName: db-secret
      defaultMode: 0400              # íŒŒì¼ ê¶Œí•œ ì„¤ì • (ì†Œìœ ì ì½ê¸°ë§Œ)
```

**í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì´ë¯¸ì§€ Pull**
```yaml
spec:
  imagePullSecrets:
    - name: regcred                    # docker-registry Secret ì°¸ì¡°
  containers:
    - name: app
      image: my-private-registry.com/my-app:v1
```

### Secret ë³´ì•ˆ ê°•í™”

```
Secretì˜ ë³´ì•ˆ í•œê³„:
  Base64ëŠ” ì¸ì½”ë”©ì¼ ë¿ ì•”í˜¸í™”ê°€ ì•„ë‹˜!
  etcdì— í‰ë¬¸(ë˜ëŠ” Base64) ì €ì¥ â†’ ëˆ„êµ¬ë“  etcd ì ‘ê·¼í•˜ë©´ ë¹„ë°€ ë…¸ì¶œ

ë³´ì•ˆ ê°•í™” ë°©ë²•:
  1. etcd ì•”í˜¸í™” (EncryptionConfiguration)
  2. RBACìœ¼ë¡œ Secret ì ‘ê·¼ ì œì–´
  3. ì™¸ë¶€ ì‹œí¬ë¦¿ ê´€ë¦¬ì ì—°ë™ (Vault, AWS Secrets Manager, Sealed Secrets ë“±)
```

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡¤ë§ ì—…ë°ì´íŠ¸(set, rollout)

**ë¬´ì¤‘ë‹¨ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒˆ ë²„ì „ìœ¼ë¡œ êµì²´**í•˜ëŠ” ë°°í¬ ì „ëµ

```
ë¡¤ë§ ì—…ë°ì´íŠ¸ ê³¼ì • (maxSurge=1, maxUnavailable=0):

Step 1:  [v1] [v1] [v1]              â† í˜„ì¬ ìƒíƒœ (replicas=3)
Step 2:  [v1] [v1] [v1] [v2]         â† ìƒˆ Pod 1ê°œ ì¶”ê°€ (maxSurge=1)
Step 3:  [v1] [v1] [  ] [v2]         â† v1 Pod 1ê°œ ì¢…ë£Œ
Step 4:  [v1] [v1] [v2] [v2]         â† ìƒˆ Pod 1ê°œ ì¶”ê°€
Step 5:  [v1] [  ] [v2] [v2]         â† v1 Pod 1ê°œ ì¢…ë£Œ
Step 6:  [v1] [v2] [v2] [v2]         â† ìƒˆ Pod 1ê°œ ì¶”ê°€
Step 7:  [  ] [v2] [v2] [v2]         â† v1 Pod 1ê°œ ì¢…ë£Œ
Step 8:  [v2] [v2] [v2]              â† ì™„ë£Œ!
```

### Deploymentì˜ ë°°í¬ ì „ëµ

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  replicas: 3
  strategy:
    type: RollingUpdate             # ê¸°ë³¸ê°’
    rollingUpdate:
      maxSurge: 1                   # ìµœëŒ€ ì´ˆê³¼ Pod ìˆ˜ (ë˜ëŠ” ë¹„ìœ¨ "25%")
      maxUnavailable: 0             # ìµœëŒ€ ë¶ˆê°€ìš© Pod ìˆ˜ (ë˜ëŠ” ë¹„ìœ¨ "25%")
  selector:
    matchLabels:
      app: my-app
  template:
    metadata:
      labels:
        app: my-app
    spec:
      containers:
        - name: app
          image: my-app:v1
```

**strategy íƒ€ì…**
| íƒ€ì… | ì„¤ëª… | ë‹¤ìš´íƒ€ì„ |
| --- | --- | --- |
| `RollingUpdate` (ê¸°ë³¸) | ì ì§„ì ìœ¼ë¡œ ìƒˆ Pod ìƒì„± + êµ¬ Pod ì œê±° | ì—†ìŒ |
| `Recreate` | ê¸°ì¡´ Pod ëª¨ë‘ ì‚­ì œ í›„ ìƒˆ Pod ìƒì„± | ìˆìŒ |

**maxSurgeì™€ maxUnavailable**
| íŒŒë¼ë¯¸í„° | ì˜ë¯¸ | ê¸°ë³¸ê°’ |
| --- | --- | --- |
| `maxSurge` | replicas ìˆ˜ë¥¼ ì´ˆê³¼í•˜ì—¬ ìƒì„± ê°€ëŠ¥í•œ Pod ìˆ˜ | 25% |
| `maxUnavailable` | ì—…ë°ì´íŠ¸ ì¤‘ ì‚¬ìš© ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆëŠ” Pod ìˆ˜ | 25% |

```
ì˜ˆì‹œ: replicas=4

maxSurge=25%, maxUnavailable=25%:
  ìµœëŒ€ Pod ìˆ˜: 4 + 1(25%) = 5
  ìµœì†Œ ê°€ìš© Pod: 4 - 1(25%) = 3
  â†’ ë™ì‹œì— ìµœëŒ€ 5ê°œ Pod, ìµœì†Œ 3ê°œ ê°€ìš©

maxSurge=1, maxUnavailable=0:
  ìµœëŒ€ Pod ìˆ˜: 4 + 1 = 5
  ìµœì†Œ ê°€ìš© Pod: 4 - 0 = 4
  â†’ í•­ìƒ 4ê°œ ê°€ìš© ë³´ì¥ (ê°€ì¥ ì•ˆì „í•˜ì§€ë§Œ ëŠë¦¼)

maxSurge=0, maxUnavailable=1:
  ìµœëŒ€ Pod ìˆ˜: 4 + 0 = 4
  ìµœì†Œ ê°€ìš© Pod: 4 - 1 = 3
  â†’ ë¦¬ì†ŒìŠ¤ ì¶”ê°€ ì—†ì´ ë°°í¬ (ë¦¬ì†ŒìŠ¤ ì œí•œ í™˜ê²½)
```

### "ê°€ìš©(Available)"ì˜ íŒë‹¨ ê¸°ì¤€ â€” readinessProbe

ë¡¤ë§ ì—…ë°ì´íŠ¸ì—ì„œ **Podê°€ "ê°€ìš©"ìœ¼ë¡œ ì¹´ìš´íŠ¸ë˜ë ¤ë©´ readinessProbeë¥¼ í†µê³¼**í•´ì•¼ í•¨

```
ìƒˆ Pod ìƒì„±
    â”‚
    â–¼
readinessProbe ì‹¤í–‰
    â”‚
    â”œâ”€ ì‹¤íŒ¨ â†’ "ê°€ìš©í•˜ì§€ ì•ŠìŒ" â†’ maxUnavailable ì¹´ìš´íŠ¸ì— í¬í•¨
    â”‚         Service ì—”ë“œí¬ì¸íŠ¸ì—ë„ ë¯¸ë“±ë¡ (íŠ¸ë˜í”½ ì•ˆ ê°)
    â”‚
    â””â”€ ì„±ê³µ â†’ minReadySeconds ê²½ê³¼ í™•ì¸
                â”‚
                â”œâ”€ ë¯¸ê²½ê³¼ â†’ ì•„ì§ "ê°€ìš©í•˜ì§€ ì•ŠìŒ"
                â”‚
                â””â”€ ê²½ê³¼ â†’ "ê°€ìš©(Available)" íŒì •
                          â†’ ê¸°ì¡´ Pod í•˜ë‚˜ ì¢…ë£Œ ì§„í–‰
```

```
replicas=3, maxSurge=1, maxUnavailable=0 + readinessProbe ì„¤ì • ì‹œ:

Step 1: [v1âœ…] [v1âœ…] [v1âœ…]           ê°€ìš©=3, ìµœì†Œ ê°€ìš©=3 âœ…
Step 2: [v1âœ…] [v1âœ…] [v1âœ…] [v2â³]    v2 ìƒì„±, readinessProbe ì•„ì§ ë¯¸í†µê³¼
                                       ê°€ìš©=3 (v2ëŠ” ë¯¸ì¹´ìš´íŠ¸)
Step 3: [v1âœ…] [v1âœ…] [v1âœ…] [v2âœ…]    v2 readinessProbe í†µê³¼!
                                       ê°€ìš©=4 â†’ ì´ì œ v1 í•˜ë‚˜ ì¢…ë£Œ ê°€ëŠ¥
Step 4: [v1âœ…] [v1âœ…] [v1ğŸ”»] [v2âœ…]    v1 í•˜ë‚˜ ì¢…ë£Œ ì‹œì‘
...
```

| ìƒí™© | ê°€ìš© íŒì • |
| --- | --- |
| readinessProbe ë¯¸ì„¤ì • | ì»¨í…Œì´ë„ˆ Running ì¦‰ì‹œ ê°€ìš© |
| readinessProbe ì„±ê³µ | ê°€ìš© (+ minReadySeconds ëŒ€ê¸° í›„) |
| readinessProbe ì‹¤íŒ¨ | ê°€ìš©í•˜ì§€ ì•ŠìŒ â†’ ë¡¤ë§ ì—…ë°ì´íŠ¸ ì§„í–‰ ë©ˆì¶¤ |
| readinessProbe ê³„ì† ì‹¤íŒ¨ | `progressDeadlineSeconds`(ê¸°ë³¸ 600ì´ˆ) ì´ˆê³¼ ì‹œ ë°°í¬ ì‹¤íŒ¨ |

- readinessProbeê°€ ë¡¤ë§ ì—…ë°ì´íŠ¸ì˜ **ì•ˆì „ì¥ì¹˜** ì—­í• 
- ìƒˆ ë²„ì „ì— ë¬¸ì œê°€ ìˆìœ¼ë©´ readinessProbe ì‹¤íŒ¨ â†’ ìë™ìœ¼ë¡œ ë°°í¬ ì¤‘ë‹¨ â†’ ê¸°ì¡´ ë²„ì „ ìœ ì§€

### kubectl set / rollout

```bash
# ì´ë¯¸ì§€ ë³€ê²½ â†’ ë¡¤ë§ ì—…ë°ì´íŠ¸ ì‹œì‘
kubectl set image deployment/my-app app=my-app:v2

# ë°°í¬ ìƒíƒœ í™•ì¸
kubectl rollout status deployment/my-app

# ë°°í¬ ì¼ì‹œ ì¤‘ì§€ / ì¬ê°œ (ì—¬ëŸ¬ ë³€ê²½ì„ ëª¨ì•„ì„œ í•œ ë²ˆì— ì ìš© ì‹œ)
kubectl rollout pause deployment/my-app
kubectl rollout resume deployment/my-app

# ë°°í¬ ì´ë ¥ í™•ì¸
kubectl rollout history deployment/my-app
```

### ë¡¤ë°± (rollout undo)

```
ë¡¤ë°± íë¦„:
  v3 (í˜„ì¬, ë¬¸ì œ ë°œìƒ!) â†’ rollout undo â†’ v2 (ì´ì „ ë²„ì „ìœ¼ë¡œ ë³µê·€)

  [v3] [v3] [v3]  â†’  rollout undo  â†’  [v2] [v2] [v2]
```

```bash
# ì§ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±
kubectl rollout undo deployment/my-app

# íŠ¹ì • ë¦¬ë¹„ì „ìœ¼ë¡œ ë¡¤ë°±
kubectl rollout undo deployment/my-app --to-revision=1
```

### ë°°í¬ ê³¼ì •ì—ì„œ ë‚´ë¶€ ë™ì‘

```
kubectl set image â†’ Deployment ì—…ë°ì´íŠ¸
                        â”‚
                        â–¼
              ìƒˆ ReplicaSet ìƒì„± (replicas: 0 â†’ ì ì§„ ì¦ê°€)
                        â”‚
                        â–¼
              ê¸°ì¡´ ReplicaSet ì¶•ì†Œ (replicas: 3 â†’ ì ì§„ ê°ì†Œ)

Deployment
 â”œâ”€ ReplicaSet (v1, replicas: 0)  â† ë³´ê´€ (ë¡¤ë°±ìš©)
 â”œâ”€ ReplicaSet (v2, replicas: 0)  â† ë³´ê´€
 â””â”€ ReplicaSet (v3, replicas: 3)  â† í˜„ì¬ í™œì„±
```

- `revisionHistoryLimit` (ê¸°ë³¸ 10): ë³´ê´€í•  ì´ì „ ReplicaSet ìˆ˜. 0ì´ë©´ ë¡¤ë°± ë¶ˆê°€
- `minReadySeconds`: ìƒˆ Podê°€ Ready í›„ ì¶”ê°€ ëŒ€ê¸° ì‹œê°„ (ì•ˆì •ì„± í™•ì¸)
- `progressDeadlineSeconds` (ê¸°ë³¸ 600ì´ˆ): ë°°í¬ê°€ ì§„í–‰ë˜ì§€ ì•Šìœ¼ë©´ ì‹¤íŒ¨ë¡œ íŒë‹¨

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë™ì ìœ¼ë¡œ ë°°í¬í•˜ê¸°(kustomize)

**ê¸°ë³¸ YAML(base)ì„ ìœ ì§€í•˜ë©´ì„œ í™˜ê²½ë³„ë¡œ ë‹¤ë¥¸ ì„¤ì •ì„ ì˜¤ë²„ë ˆì´(overlay)**í•˜ëŠ” ë„êµ¬

```
ê¸°ì¡´ ë¬¸ì œ:
  dev.yaml, staging.yaml, prod.yaml â†’ ì¤‘ë³µì´ ë§ê³  ê´€ë¦¬ í˜ë“¦

Kustomize í•´ê²°:
  base (ê³µí†µ) + overlay (í™˜ê²½ë³„ ì°¨ì´ë§Œ) â†’ ì¡°í•©í•˜ì—¬ ìµœì¢… YAML ìƒì„±

  base/
   â”œâ”€ deployment.yaml     â† ê³µí†µ ì„¤ì •
   â”œâ”€ service.yaml
   â””â”€ kustomization.yaml

  overlays/
   â”œâ”€ dev/
   â”‚   â””â”€ kustomization.yaml   â† replicas: 1, ì´ë¯¸ì§€ íƒœê·¸: dev
   â”œâ”€ staging/
   â”‚   â””â”€ kustomization.yaml   â† replicas: 2, ì´ë¯¸ì§€ íƒœê·¸: staging
   â””â”€ prod/
       â””â”€ kustomization.yaml   â† replicas: 5, ì´ë¯¸ì§€ íƒœê·¸: v1.2.3
```

### base ì„¤ì •

```yaml
# base/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - deployment.yaml
  - service.yaml
```

```yaml
# base/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: my-app
spec:
  replicas: 1
  selector:
    matchLabels:
      app: my-app
  template:
    metadata:
      labels:
        app: my-app
    spec:
      containers:
        - name: app
          image: my-app:latest
          ports:
            - containerPort: 8080
```

### overlay ì„¤ì •

```yaml
# overlays/dev/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../base                       # base ë””ë ‰í† ë¦¬ ì°¸ì¡°
namePrefix: dev-                     # ëª¨ë“  ë¦¬ì†ŒìŠ¤ ì´ë¦„ì— ì ‘ë‘ì‚¬
namespace: dev                       # ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì§€ì •
commonLabels:                        # ê³µí†µ ë ˆì´ë¸” ì¶”ê°€
  environment: dev
images:                              # ì´ë¯¸ì§€ íƒœê·¸ ë³€ê²½
  - name: my-app
    newTag: dev-latest
patches:                             # íŒ¨ì¹˜ ì ìš©
  - target:
      kind: Deployment
      name: my-app
    patch: |
      - op: replace
        path: /spec/replicas
        value: 1
```

### Kustomize ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
| --- | --- |
| `namePrefix` / `nameSuffix` | ë¦¬ì†ŒìŠ¤ ì´ë¦„ì— ì ‘ë‘ì‚¬/ì ‘ë¯¸ì‚¬ |
| `namespace` | ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì¼ê´„ ì§€ì • |
| `commonLabels` | ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ë ˆì´ë¸” ì¶”ê°€ |
| `images` | ì´ë¯¸ì§€ ì´ë¦„/íƒœê·¸ ë³€ê²½ |
| `configMapGenerator` | ConfigMap ìë™ ìƒì„± (í•´ì‹œ suffix â†’ ë³€ê²½ ì‹œ Pod ìë™ ì¬ì‹œì‘) |
| `secretGenerator` | Secret ìë™ ìƒì„± |
| `patches` | ë¦¬ì†ŒìŠ¤ ë¶€ë¶„ ìˆ˜ì • (JSON Patch, Strategic Merge Patch) |

### kubectl ì‚¬ìš©

```bash
# ë¹Œë“œ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° (ì‹¤ì œ ì ìš© ì•ˆí•¨)
kubectl kustomize overlays/dev

# ì ìš©
kubectl apply -k overlays/dev

# ì‚­ì œ
kubectl delete -k overlays/dev
```

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë”ìš±ë” ì‰½ê²Œ ë°°í¬í•˜ê¸°(helm)

Kubernetesì˜ **íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €** â€” ë³µì¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í•˜ë‚˜ì˜ íŒ¨í‚¤ì§€(Chart)ë¡œ ê´€ë¦¬

```
ë¹„ìœ :
  apt/yumì´ ë¦¬ëˆ…ìŠ¤ì˜ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ì¸ ê²ƒì²˜ëŸ¼
  Helmì€ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €

  apt install nginx      â†’  helm install my-nginx bitnami/nginx
  apt upgrade nginx      â†’  helm upgrade my-nginx bitnami/nginx
  apt remove nginx       â†’  helm uninstall my-nginx

Helmì˜ 3ê°€ì§€ í•µì‹¬ ê°œë…:
  Chart      â†’ íŒ¨í‚¤ì§€ (YAML í…œí”Œë¦¿ + ê¸°ë³¸ê°’)
  Release    â†’ Chartì˜ ì„¤ì¹˜ ì¸ìŠ¤í„´ìŠ¤ (ê°™ì€ Chartë¥¼ ì—¬ëŸ¬ ë²ˆ ì„¤ì¹˜ ê°€ëŠ¥)
  Repository â†’ Chart ì €ì¥ì†Œ (bitnami, stable ë“±)
```

### Chart êµ¬ì¡°

```
my-chart/
 â”œâ”€ Chart.yaml              # ì°¨íŠ¸ ë©”íƒ€ë°ì´í„° (ì´ë¦„, ë²„ì „, ì„¤ëª…)
 â”œâ”€ values.yaml             # ê¸°ë³¸ ì„¤ì •ê°’
 â”œâ”€ templates/              # Kubernetes ë§¤ë‹ˆí˜ìŠ¤íŠ¸ í…œí”Œë¦¿ (Go template)
 â”‚   â”œâ”€ deployment.yaml
 â”‚   â”œâ”€ service.yaml
 â”‚   â”œâ”€ _helpers.tpl        # í…œí”Œë¦¿ í—¬í¼ í•¨ìˆ˜
 â”‚   â””â”€ NOTES.txt           # ì„¤ì¹˜ í›„ ì•ˆë‚´ ë©”ì‹œì§€
 â”œâ”€ charts/                 # ì˜ì¡´ ì°¨íŠ¸ (ì„œë¸Œì°¨íŠ¸)
 â””â”€ .helmignore
```

**values.yaml â€” ì‚¬ìš©ìê°€ ì˜¤ë²„ë¼ì´ë“œí•˜ëŠ” ê¸°ë³¸ ì„¤ì •ê°’**
```yaml
replicaCount: 3
image:
  repository: my-app
  tag: "v1.2.3"
  pullPolicy: IfNotPresent
service:
  type: ClusterIP
  port: 80
resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 250m
    memory: 128Mi
```

**templatesì—ì„œ values ì°¸ì¡° (Go í…œí”Œë¦¿)**
```yaml
# {{ .Values.xxx }}ë¡œ values.yaml ê°’ ì°¸ì¡°
replicas: {{ .Values.replicaCount }}
image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}"
```

### Helm ê¸°ë³¸ ëª…ë ¹ì–´

```bash
# ë¦¬í¬ì§€í† ë¦¬ ì¶”ê°€
helm repo add bitnami https://charts.bitnami.com/bitnami
helm repo update

# ì°¨íŠ¸ ì„¤ì¹˜
helm install my-release bitnami/nginx

# values ì˜¤ë²„ë¼ì´ë“œ (--set ë˜ëŠ” -f)
helm install my-release bitnami/nginx --set replicaCount=3
helm install my-release bitnami/nginx -f my-values.yaml

# ì—…ê·¸ë ˆì´ë“œ
helm upgrade my-release bitnami/nginx -f new-values.yaml

# ì—…ê·¸ë ˆì´ë“œ + ì—†ìœ¼ë©´ ì„¤ì¹˜ (CI/CDì—ì„œ ìœ ìš©)
helm upgrade --install my-release bitnami/nginx -f values.yaml

# ë¡¤ë°±
helm rollback my-release              # ì§ì „ ë¦¬ë¹„ì „ìœ¼ë¡œ
helm rollback my-release 1            # íŠ¹ì • ë¦¬ë¹„ì „ìœ¼ë¡œ

# ì‚­ì œ
helm uninstall my-release

# ì„¤ì¹˜ ì „ ë Œë”ë§ í™•ì¸
helm template my-release bitnami/nginx -f my-values.yaml
```

### Kustomize vs Helm ë¹„êµ

| ë¹„êµ í•­ëª© | Kustomize | Helm |
| --- | --- | --- |
| ì ‘ê·¼ ë°©ì‹ | íŒ¨ì¹˜/ì˜¤ë²„ë ˆì´ (YAML ì§ì ‘ ìˆ˜ì •) | í…œí”Œë¦¿ ì—”ì§„ (Go template) |
| í•™ìŠµ ê³¡ì„  | ë‚®ìŒ (ìˆœìˆ˜ YAML) | ì¤‘ê°„ (Go í…œí”Œë¦¿ ë¬¸ë²•) |
| íŒ¨í‚¤ì§€/ë¦´ë¦¬ìŠ¤ ê´€ë¦¬ | ì—†ìŒ | Chart ë¦¬í¬ì§€í† ë¦¬, ë²„ì „ ê´€ë¦¬, ë¡¤ë°± |
| ì˜ì¡´ì„± ê´€ë¦¬ | ì—†ìŒ | ì„œë¸Œì°¨íŠ¸, dependencies |
| ë‚´ì¥ ì—¬ë¶€ | kubectlì— ë‚´ì¥ (`-k`) | ë³„ë„ ì„¤ì¹˜ í•„ìš” |
| ì í•©í•œ ìƒí™© | í™˜ê²½ë³„ ì„¤ì • ì°¨ì´ê°€ ì ì„ ë•Œ | ë³µì¡í•œ ì•±, ì¬ì‚¬ìš©/ë°°í¬ íŒ¨í‚¤ì§€ |

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìì› ì‚¬ìš©ëŸ‰ í™•ì¸í•˜ê¸°(ë©”íŠ¸ë¦­ ì„œë²„ / Metrics-server)

**í´ëŸ¬ìŠ¤í„° ë‚´ ë…¸ë“œì™€ Podì˜ CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìˆ˜ì§‘**í•˜ëŠ” ê²½ëŸ‰ ëª¨ë‹ˆí„°ë§ ì»´í¬ë„ŒíŠ¸

```
Metrics Server ì—­í• :

ê° ë…¸ë“œì˜ kubelet (cAdvisor)
  â”œâ”€ Node-1 kubelet â”€â”€â†’ CPU/Memory ë©”íŠ¸ë¦­
  â”œâ”€ Node-2 kubelet â”€â”€â†’ CPU/Memory ë©”íŠ¸ë¦­
  â””â”€ Node-3 kubelet â”€â”€â†’ CPU/Memory ë©”íŠ¸ë¦­
          â”‚
          â–¼
    Metrics Server (ìˆ˜ì§‘ & ì§‘ê³„)
          â”‚
          â–¼
    Metrics API (/apis/metrics.k8s.io/v1beta1)
          â”‚
          â”œâ”€â”€â†’ kubectl top         (ì‚¬ìš©ì ì¡°íšŒ)
          â”œâ”€â”€â†’ HPA                 (ìë™ ìŠ¤ì¼€ì¼ë§ íŒë‹¨)
          â””â”€â”€â†’ VPA                 (ìë™ ë¦¬ì†ŒìŠ¤ ì¡°ì •)
```

### Metrics Server íŠ¹ì§•

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| ìˆ˜ì§‘ ì£¼ê¸° | ê¸°ë³¸ 15ì´ˆ ê°„ê²© |
| ì €ì¥ ê¸°ê°„ | **ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥** â€” ìµœì‹  ê°’ë§Œ ìœ ì§€ (íˆìŠ¤í† ë¦¬ ì—†ìŒ) |
| ìš©ë„ | kubectl top, HPA, VPAì˜ ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ì†ŒìŠ¤ |
| í•œê³„ | ê³¼ê±° ë°ì´í„° ì¡°íšŒ ë¶ˆê°€ â†’ ì¥ê¸° ëª¨ë‹ˆí„°ë§ì€ Prometheus ë“± ì‚¬ìš© |

```
ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì—­í•  ë¶„ë‹´:

Metrics Server â†’ ì‹¤ì‹œê°„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ (HPA, kubectl top)
Prometheus     â†’ ì‹œê³„ì—´ ë©”íŠ¸ë¦­ ìˆ˜ì§‘, ì¥ê¸° ì €ì¥, ì•Œë¦¼
Grafana        â†’ ëŒ€ì‹œë³´ë“œ ì‹œê°í™”
```

---

## ìì› ìƒíƒœì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìë™ìœ¼ë¡œ ì¡°ì ˆí•˜ê¸°(HPA)

**Horizontal Pod Autoscaler** â€” Podì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì´ë‚˜ ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ì— ë”°ë¼ **Pod ìˆ˜ë¥¼ ìë™ ì¡°ì ˆ**

```
HPA ë™ì‘ ì›ë¦¬:

  Metrics Server â”€â”€(ë©”íŠ¸ë¦­ ìˆ˜ì§‘)â”€â”€â†’ HPA Controller
                                        â”‚
                                   í˜„ì¬ CPU: 80%
                                   ëª©í‘œ CPU: 50%
                                        â”‚
                                        â–¼
                                  "Podê°€ ë¶€ì¡±í•˜ë‹¤"
                                        â”‚
                                        â–¼
                              Deployment replicas ì¦ê°€
                                   3 â†’ 5ê°œ

  ë¶€í•˜ ì¦ê°€ ì‹œ (Scale Out):
    [Pod] [Pod] [Pod]  â†’  [Pod] [Pod] [Pod] [Pod] [Pod]

  ë¶€í•˜ ê°ì†Œ ì‹œ (Scale In):
    [Pod] [Pod] [Pod] [Pod] [Pod]  â†’  [Pod] [Pod] [Pod]
```

### HPA ìƒì„±

```bash
# ëª…ë ¹í˜•: CPU ì‚¬ìš©ë¥  50% ê¸°ì¤€, ìµœì†Œ 2ê°œ ~ ìµœëŒ€ 10ê°œ
kubectl autoscale deployment my-app --cpu-percent=50 --min=2 --max=10
```

```yaml
# ì„ ì–¸í˜• (v2)
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: my-app-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: my-app
  minReplicas: 2
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 50     # í‰ê·  CPU ì‚¬ìš©ë¥  50% ìœ ì§€ ëª©í‘œ
```

### ìŠ¤ì¼€ì¼ë§ ê³„ì‚° ê³µì‹

```
í•„ìš” Pod ìˆ˜ = ceil(í˜„ì¬ Pod ìˆ˜ Ã— (í˜„ì¬ ë©”íŠ¸ë¦­ ê°’ / ëª©í‘œ ë©”íŠ¸ë¦­ ê°’))

ì˜ˆì‹œ:
  í˜„ì¬ Pod ìˆ˜: 3
  í˜„ì¬ í‰ê·  CPU: 90%
  ëª©í‘œ CPU: 50%

  í•„ìš” Pod ìˆ˜ = ceil(3 Ã— (90 / 50)) = ceil(5.4) = 6
  â†’ 3ê°œ â†’ 6ê°œë¡œ ìŠ¤ì¼€ì¼ ì•„ì›ƒ
```

### HPA ë™ì‘ ì¡°ê±´

- **ì „ì œ: Podì— resources.requestsê°€ ë°˜ë“œì‹œ ì„¤ì •**ë˜ì–´ ìˆì–´ì•¼ í•¨ (requests ëŒ€ë¹„ ì‚¬ìš©ë¥  ê³„ì‚°)
- **Metrics Serverê°€ ì„¤ì¹˜**ë˜ì–´ ìˆì–´ì•¼ í•¨

### ìŠ¤ì¼€ì¼ë§ ë™ì‘ ì œì–´ (behavior)

```yaml
behavior:
  scaleUp:
    stabilizationWindowSeconds: 0      # ì¦‰ì‹œ ìŠ¤ì¼€ì¼ ì•„ì›ƒ
    policies:
      - type: Percent
        value: 100                     # í˜„ì¬ì˜ 100%ê¹Œì§€ í•œ ë²ˆì— ì¦ê°€
        periodSeconds: 60
    selectPolicy: Max
  scaleDown:
    stabilizationWindowSeconds: 300    # 5ë¶„ê°„ ì•ˆì •í™” í›„ ìŠ¤ì¼€ì¼ ë‹¤ìš´
    policies:
      - type: Percent
        value: 10                      # í•œ ë²ˆì— 10%ì”©ë§Œ ê°ì†Œ
        periodSeconds: 60
```

```
scaleUp: stabilizationWindowSeconds: 0 â†’ ë¶€í•˜ ì¦ê°€ì— ì¦‰ì‹œ ë°˜ì‘
scaleDown: stabilizationWindowSeconds: 300 â†’ 5ë¶„ ëŒ€ê¸° í›„ ì¶•ì†Œ
  â†’ "í”Œë˜í•‘(flapping)" ë°©ì§€ (ìŠ¤ì¼€ì¼ ì•„ì›ƒ/ì¸ì´ ë¹ˆë²ˆí•˜ê²Œ ë°˜ë³µë˜ëŠ” í˜„ìƒ)
```

### HPA ì£¼ì˜ì‚¬í•­

| ì£¼ì˜ì‚¬í•­ | ì„¤ëª… |
| --- | --- |
| requests í•„ìˆ˜ | Podì— resources.requestsê°€ ì—†ìœ¼ë©´ CPU ì‚¬ìš©ë¥  ê³„ì‚° ë¶ˆê°€ |
| Metrics Server í•„ìˆ˜ | HPAì˜ ë©”íŠ¸ë¦­ ì†ŒìŠ¤ |
| ì¿¨ë‹¤ìš´ ê¸°ê°„ | ê¸°ë³¸ ìŠ¤ì¼€ì¼ ë‹¤ìš´ ì•ˆì •í™”: 5ë¶„ (ê¸‰ê²©í•œ ì¶•ì†Œ ë°©ì§€) |
| HPA + ìˆ˜ë™ ìŠ¤ì¼€ì¼ë§ ì¶©ëŒ | HPA í™œì„± ì¤‘ `kubectl scale`ì€ HPAê°€ ë®ì–´ì”€ |
| VPAì™€ ë™ì‹œ ì‚¬ìš© ì£¼ì˜ | HPA(ìˆ˜í‰)ì™€ VPA(ìˆ˜ì§)ê°€ ê°™ì€ ë©”íŠ¸ë¦­(CPU)ì„ ì‚¬ìš©í•˜ë©´ ì¶©ëŒ |

### ì´ë²¤íŠ¸ ê¸°ë°˜ ì˜¤í† ìŠ¤ì¼€ì¼ë§ â€” KEDA

**KEDA (Kubernetes Event-Driven Autoscaler)** â€” ì™¸ë¶€ ì´ë²¤íŠ¸ ì†ŒìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Pod ìˆ˜ë¥¼ ì¡°ì ˆí•˜ëŠ” í™•ì¥ ì˜¤í† ìŠ¤ì¼€ì¼ëŸ¬

```
HPA vs KEDA:

HPA:
  Metrics Server â†’ CPU/Memory ì‚¬ìš©ë¥  ê¸°ë°˜ â†’ Pod ìˆ˜ ì¡°ì ˆ
  "CPUê°€ 80%ë‹ˆê¹Œ Podë¥¼ ëŠ˜ë ¤ì•¼ì§€"

KEDA:
  ì™¸ë¶€ ì´ë²¤íŠ¸ ì†ŒìŠ¤ ê¸°ë°˜ â†’ Pod ìˆ˜ ì¡°ì ˆ (0ê¹Œì§€ ì¶•ì†Œ ê°€ëŠ¥!)
  "Kafka íì— ë©”ì‹œì§€ê°€ 1000ê°œ ë°€ë ¸ìœ¼ë‹ˆ Podë¥¼ ëŠ˜ë ¤ì•¼ì§€"
  "íê°€ ë¹„ì—ˆìœ¼ë‹ˆ Podë¥¼ 0ê°œë¡œ ì¤„ì—¬ì•¼ì§€"
```

```
ì™¸ë¶€ ì´ë²¤íŠ¸ ì†ŒìŠ¤ (Kafka, RabbitMQ, SQS ë“±)
          â”‚
          â–¼
    KEDA Operator (ì´ë²¤íŠ¸ ê°ì‹œ)
          â”‚
          â”œâ”€ ì´ë²¤íŠ¸ ìˆìŒ â†’ Pod 0 â†’ 1ë¡œ í™œì„±í™”
          â”‚                â†’ ì´í›„ HPAì²˜ëŸ¼ ìŠ¤ì¼€ì¼ ì•„ì›ƒ
          â”‚
          â””â”€ ì´ë²¤íŠ¸ ì—†ìŒ â†’ Pod â†’ 0ìœ¼ë¡œ ìŠ¤ì¼€ì¼ ë‹¤ìš´
```

- KEDAëŠ” ë‚´ë¶€ì ìœ¼ë¡œ **HPAë¥¼ ìƒì„±í•˜ì—¬ ìœ„ì„** (HPAë¥¼ ëŒ€ì²´í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ í™•ì¥)
- 0 â†’ 1, 1 â†’ 0 ì „í™˜ë§Œ KEDAê°€ ì§ì ‘ ê´€ë¦¬í•˜ê³ , 1 ì´ìƒì˜ ìŠ¤ì¼€ì¼ë§ì€ HPAì— ë§¡ê¹€

| ë¹„êµ | HPA | KEDA |
| --- | --- | --- |
| ë©”íŠ¸ë¦­ ì†ŒìŠ¤ | CPU/Memory (Metrics Server) | ì™¸ë¶€ ì´ë²¤íŠ¸ ì†ŒìŠ¤ (Kafka, SQS, Redis ë“±) |
| ìµœì†Œ Pod ìˆ˜ | **1ê°œ** (0 ë¶ˆê°€) | **0ê°œ** ê°€ëŠ¥ (ì´ë²¤íŠ¸ ì—†ìœ¼ë©´ ì™„ì „ ì¢…ë£Œ) |
| ìŠ¤ì¼€ì¼ë§ íŠ¸ë¦¬ê±° | ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥  | í ê¸¸ì´, DB í–‰ ìˆ˜, cron, HTTP ìš”ì²­ ìˆ˜ ë“± |
| ë¹„ìš© íš¨ìœ¨ | Pod ìµœì†Œ 1ê°œ ìœ ì§€ | ì´ë²¤íŠ¸ ì—†ìœ¼ë©´ ë¦¬ì†ŒìŠ¤ ì™„ì „ ë°˜ë‚© |

**ëŒ€í‘œ í™œìš© ì‚¬ë¡€**
- ë©”ì‹œì§€ í ì»¨ìŠˆë¨¸: Kafka/RabbitMQ/SQSì— ë©”ì‹œì§€ ìŒ“ì´ë©´ ì›Œì»¤ Pod ì¦ê°€, ë¹„ë©´ 0ìœ¼ë¡œ
- ë°°ì¹˜ ì²˜ë¦¬: ì²˜ë¦¬í•  ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ Pod ê°€ë™
- Cron ê¸°ë°˜: íŠ¹ì • ì‹œê°„ì—ë§Œ Pod í™œì„±í™”
- HTTP ê¸°ë°˜: ìš”ì²­ ì—†ìœ¼ë©´ 0ìœ¼ë¡œ ì¶•ì†Œ (ì„œë²„ë¦¬ìŠ¤ì™€ ìœ ì‚¬)

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì›¹UIì—ì„œ ê´€ë¦¬í•˜ê¸°(kube dashboard)

Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ **ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì‹œê°ì ìœ¼ë¡œ ê´€ë¦¬**í•  ìˆ˜ ìˆëŠ” ê³µì‹ ëŒ€ì‹œë³´ë“œ

```
Kubernetes Dashboard:

  ë¸Œë¼ìš°ì € â”€â”€(HTTPS)â”€â”€â†’ Dashboard Pod â”€â”€(API)â”€â”€â†’ API Server
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Dashboard UI       â”‚
                    â”‚  â”œâ”€ ì›Œí¬ë¡œë“œ ì¡°íšŒ    â”‚
                    â”‚  â”œâ”€ Pod ë¡œê·¸ í™•ì¸    â”‚
                    â”‚  â”œâ”€ ë¦¬ì†ŒìŠ¤ ìƒì„±/ìˆ˜ì •  â”‚
                    â”‚  â”œâ”€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì „í™˜  â”‚
                    â”‚  â””â”€ ë¦¬ì†ŒìŠ¤ ì‚­ì œ      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dashboard ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
| --- | --- |
| ì›Œí¬ë¡œë“œ ì¡°íšŒ | Deployment, Pod, ReplicaSet, Job ë“± ìƒíƒœ í™•ì¸ |
| ë¦¬ì†ŒìŠ¤ ìƒì„± | YAML ì—ë””í„° ë˜ëŠ” í¼ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ ìƒì„± |
| Pod ë¡œê·¸ | ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë° |
| Pod exec | ì›¹ í„°ë¯¸ë„ì—ì„œ ì»¨í…Œì´ë„ˆ ì ‘ì† |
| ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì „í™˜ | ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„ íƒ |
| ë¦¬ì†ŒìŠ¤ ìˆ˜ì •/ì‚­ì œ | YAML í¸ì§‘ ë° ì‚­ì œ |
| í´ëŸ¬ìŠ¤í„° ìƒíƒœ | ë…¸ë“œ, PV, StorageClass ë“± í™•ì¸ |

### ë³´ì•ˆ ì£¼ì˜ì‚¬í•­

```
Dashboard ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸:

âœ… ì™¸ë¶€ ì¸í„°ë„·ì— ì§ì ‘ ë…¸ì¶œí•˜ì§€ ì•Šê¸°
  â†’ kubectl proxy, port-forward, VPN ê²½ìœ ë¡œ ì ‘ì†

âœ… ìµœì†Œ ê¶Œí•œ ì›ì¹™
  â†’ cluster-admin ëŒ€ì‹  í•„ìš”í•œ ê¶Œí•œë§Œ ë¶€ì—¬
  â†’ namespaceë³„ Role + RoleBinding ì‚¬ìš©

âœ… HTTPS ì‚¬ìš©
  â†’ DashboardëŠ” ê¸°ë³¸ì ìœ¼ë¡œ HTTPS

âœ… ë„¤íŠ¸ì›Œí¬ ì •ì±… ì ìš©
  â†’ Dashboard Podì— ëŒ€í•œ ì ‘ê·¼ì„ ì œí•œ

âŒ skip ë¡œê·¸ì¸ ë¹„í™œì„±í™”
  â†’ --enable-skip-login ì‚¬ìš© ê¸ˆì§€ (í”„ë¡œë•ì…˜)
```
