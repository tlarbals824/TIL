# Redis와 캐시

## 캐시란?

* 캐시는 데이터의 원본보다 더 빠르고 효율적으로 액세스 할 수 있는 임시 데이터 저장소를 의미합니다.
* 캐시를 통해 반복적으로 조회되는 데이터에 대해 사용하는 리소스를 줄일 수 있습니다.
* 애플리케이션이 다음 조건을 만족한다면 캐시를 도입했을 때 성능을 개선시킬 수 있습니다.
  * 원본 데이터 저장소에서 원하는 데이터를 찾기 위해 검색하는 시간이 오래 걸리거나, 매번 계산을 통해 데이터를 가져와야 하는 경우
  * 캐시에서 데이터를 가져오는 것이 원본 데이터 저장소 데이터를 요청하는 것보다 빨라야 하는 경우
  * 캐시에 저장된 데이터는 잘 변하지 않는 데이터인 경우
  * 캐시에 저장된 데이터는 자주 검색되는 데이터인 경우
* 캐시는 데이터의 복제본을 저장하는 저장소이기 떄문에 원본 데이터 저장소에서 데이터를 읽는 커넥션을 줄일 수 있습니다.

## 캐시로서 Redis

* Redis는 키-값 저장소이고 다양한 자료 구조를 지원하기 때문에 캐시로 사용하기에 적합합니다.
* Redis는 인메모리 저장소이기 때문에 데이터를 검색하고 반환하는 것이 상당히 빠릅니다. 평균 읽기 및 쓰기 작업 속도가 1ms 미만이며, 초당 수백만 건의 작업이 가능합니다.
* Redis는 자체적으로 고가용성 기능을 가지는 솔루션입니다. 즉, 단일 장애 지점이 없으며, 데이터를 여러 서버에 복제할 수 있습니다.
* Redis의 클러스터를 통해 캐시의 스케일 아웃을 쉽게 처리할 수 있습니다.

## 캐시 전략

### 일기 전략 - look aside

<img src="img/lookaside.svg" width="600">

* Redis를 캐시로 사용하는 경우 look aside 전략을 주로 사용합니다.
* look aside 전략의 경우 캐시 히트와 캐시 미스 상황으로 나눌 수 있습니다.
  * 캐시 히트 : 애플리케이션이 찾는 데이터가 캐시의 존재하는 경우, 해당 데이터를 캐시에서 조회합니다.
  * 캐시 미스 : 애플리케이션이 찾는 데이터가 캐시의 존재하지 않는 경우, 해당 데이터를 원본 데이터 저장소에서 조회합니다. 이후 조회된 데이터를 캐시에 저장합니다.
* look aside의 장점은 Redis에 문제가 생겨 접근할 수 없는 상황이 발생하더라도 서비스 장애로 이어지지 않고 원본 데이터 저장소에서 데이터를 조회할 수 있다는 점입니다.
하지만 원본 데이터 저장소에 많은 부하가 발생해 애플리케이션 성능에 영향을 미칠 수 있습니다.
* 찾고자 하는 데이터가 Redis에 없을 때에만 Redis에 데이터가 저장되기 때문에 이와 같은 구조를 Lazy Loading이라고 합니다.
* 미리 데이터를 캐시에 저장해 두는 방식을 캐시 워밍(Cache Warming)이라고 합니다.